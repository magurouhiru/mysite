{"author":"magurouhiru","date":"2024/9/11","tags":["Markdown","Angular"]}
# Markdown にメタデータを追加してGitHub Pages に一覧表示させるまで

## やったこと
Markdown にメタデータ（作者、作成日、タグ）を追加し、そのデータを元に作成済みのGitHub Pages のサイトに一覧表示させた。<br>


## 前提
- GitHub Pages にメディアサイト？は作成済み<br>
- 記事一覧ページには最初の100文字だけ仮に表示させてて分かりにくい！！<br>
詳しくは前々回記事参照<br>
https://qiita.com/magurouhiru/items/5aa7a2dd70d7ea56a081<br>

## 1. Markdown にメタデータを追加する方法
### 最初のイメージ
Markdown にコメントだったりhtml のヘッダーだったりをつけるイメージ。<br>
表示はされないけど、存在はしていて生ファイル見たら読めるみたいなやつ。<br>

### メタデータのつけ方
ざっと調べたらいくつか見つかった。<br>
- コメント的な奴（ファイルのどこに書いてもOK）<br>
  - `[](ここに書く)`<br>
    - 複数行も末尾に\を入れれば行けるらしい。（私の環境ではダメだったけど。）<br>
  - `<!-- ここに書く -->`<br>
    - htmlと同じ書き方。複数行もOK。<br>
- html のヘッダー的な奴（ファイルの頭に書く）<br>
  - `---`で上下からはさむ。<br>
    - 複数行もOK。<br>

参考<br>
https://qiita.com/yu0819ki/items/e1e1d20cedc68706ba23<br>
https://dev.classmethod.jp/articles/parse-md-markdown-meta-data/<br>

いくつかあるんだなあ3番目が雰囲気好きだなあ。<br>
と思ったけど少し気になって、いくつかの環境で書いてみた結果。<br>

| `[](ここに書く)`                              | `<!-- ここに書く -->` | ---<br>ここに書く<br>---                   |
|------------------------------------------|------------------|---------------------------------------|
| ngx-markdown：△1<br>私のエディタ：△2<br>Qiita：△3 | ngx-markdown：▲<br>私のエディタ：〇<br>Qiita：〇 | ngx-markdown：×<br>私のエディタ：〇<br>Qiita：× |

※ △1は末に\をつけても複数行はNGだった。あとスペースがあったらダメだった。<br>
※ △2は末に\をつけても複数行はNGだった。<br>
※ △3は末に\をつけても複数行はNGだった。あと全角スペースがあったらダメだった。<br>
※ ▲は消えたけどwarningがでてた。<br>

ということで結構ばらつきがあった。<br>
ngx-markdown（Angular で使用しているMarkdown →htmlにしてくれるいいやつ）の優先度が一番高い。<br>
したがって消去法的に`[](ここに書く)`の書き方を使うしかないが...<br>

### ほんとに`[](ここに書く)`を使っていいの？
なんだか怪しく思えてきた。これってどこかで見た気がするんだよなー<br>
そもそもMarkdown ってだれが仕様を決めてるの？<br>
調べてもよくわからなかったのでウィキペディアさんに聞きました。<br>
どうやら↓のサイトが公式の仕様を決めてるっぽい。<br>
https://daringfireball.net/projects/markdown/<br>

斜め見だけどコメントとかメタデータとかの記載がなかった。<br>
加えてngx-markdown の出力したhtml 見るとアンカータグがあった。<br>
![img.png](articles/004/1-1.png)

つまり、もともとの仕様的には`[](ここに書く)`はコメントではなくアンカータグであり、見えないのは`[]`内に何もかいてないからである。<br>
だとすると今回の目的ではつかいたくないな。<br>
悪さする気はしないけど、一般公開する場所に乗せるのは気乗りしない。<br>

ということは...全滅ですね！<br>

### じゃあどうするの？
ファイルの先頭にJSON でメタデータ書く。<br>
ngx-markdown に食べさせるときはJSON を除外する。<br>

まあ決まりがないなら好き勝手やっていいってことじゃない！<br>

## 2. Angular アプリの改修
JSON は特にひねりとかなく↓の形でやる。<br>
`{"author":"作者名","date":"yyyy/mm/dd",tags":["タグ1","タグ2"...]}`<br>
ファイルの頭につけて、最初の行だけ抜き出して、パースして、ちょっといじって表示するだけ。<br>
あとはあまり書くことはないかな？<br>

ということで、今回の成果です！<br>
![img.png](articles/004/2-1.png)

うーん、まだましになったかな？<br>
この後きっと見た目整えるから、とりあえずOK<br>

### おまけ
前回GitHub Actions にlint と prettier のチェックを入れた動作確認です。<br>
https://github.com/magurouhiru/mysite/actions<br>
![img.png](articles/004/3-1.png)

今回の記事は以上です。<br>

詳細見たい人はこちら<br>
https://github.com/magurouhiru/mysite/pull/19<br>
https://magurouhiru.github.io/mysite/<br>
